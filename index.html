<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GamaHN â€” Bienes RaÃ­ces</title>
  <meta name="description" content="Compra, vende o renta tu prÃ³xima propiedad con GamaHN. Encuentra casas, departamentos, oficinas y mÃ¡s." />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- Navbar -->
  <header class="nav">
    <a class="brand" href="#home">GamaHN</a>
    <nav class="nav-links">
      <a href="#propiedades">Propiedades</a>
      <a href="#servicios">Servicios</a>
      <a href="#contacto">Contacto</a>
      <button id="toggle-theme">ðŸŒ“</button>
    </nav>
    <button id="navToggle" class="nav-toggle">â˜°</button>
  </header>

  <!-- Hero -->
  <section id="home" class="hero">
    <div class="hero-content">
      <h1>Encuentra tu prÃ³ximo hogar</h1>
      <p>Compra, vende o renta con expertos.</p>
      <form id="buscador" class="search">
        <input type="text" id="q" placeholder="Ciudad o tÃ­tulo">
        <select id="tipo">
          <option value="">Tipo</option>
          <option value="Casa">Casa</option>
          <option value="Departamento">Departamento</option>
          <option value="Oficina">Oficina</option>
        </select>
        <select id="precio">
          <option value="">Precio</option>
          <option value="0-100000">Hasta L.100k</option>
          <option value="100000-300000">L.100k â€“ L.300k</option>
          <option value="300000-600000">L.300k â€“ L.600k</option>
          <option value="600000-9999999">L.600k +</option>
        </select>
        <select id="recamaras">
          <option value="">RecÃ¡maras</option>
          <option value="1">1+</option>
          <option value="2">2+</option>
          <option value="3">3+</option>
          <option value="4">4+</option>
        </select>
        <button type="submit" class="btn-primary">Buscar</button>
      </form>
    </div>
  </section>

  <!-- Propiedades -->
  <section id="propiedades" class="section container">
    <h2 class="section-head">Propiedades destacadas</h2>
    <div id="filtrosSecundarios" class="filters">
      <button class="chip active" data-chip="todas">Todas</button>
      <button class="chip" data-chip="venta">En venta</button>
      <button class="chip" data-chip="renta">En renta</button>
      <button class="chip" data-chip="nueva">Nueva</button>
      <button class="chip" data-chip="lujo">Lujo</button>
      <div class="chip" data-chip="airbnb">Airbnb</div>

    </div>
    <div id="grid" class="grid"></div>
    <div id="paginacion" class="form-actions" hidden>
      <button data-page="prev" class="btn-outline">Anterior</button>
      <span>PÃ¡gina <b id="pageCur">1</b> de <b id="pageMax">1</b></span>
      <button data-page="next" class="btn-outline">Siguiente</button>
    </div>
  </section>

  <!-- Modal -->
  <dialog id="detalleModal" class="modal">
    <div class="modal-card">
      <button class="modal-close">âœ–</button>
      <div class="modal-media"><img id="modalImg" src="" alt=""></div>
      <div class="modal-body">
        <h3 id="modalTitulo"></h3>
        <p id="modalUbicacion" class="muted"></p>
        <div id="modalBadges" class="badges"></div>
        <p id="modalDesc"></p>
        <div class="modal-actions">
          <a id="btnContactar" href="#contacto" class="btn-primary">Contactar</a>
          <button id="btnFav" class="btn-fav" aria-pressed="false">â™¡</button>
        </div>
      </div>
    </div>
  </dialog>

  <!-- Contacto -->
  <section id="contacto" class="section alt">
    <div class="container">
      <header class="section-head">
        <h2>Hablemos</h2>
        <p class="muted">Agenda una visita o solicita una valuaciÃ³n gratuita.</p>
      </header>

      <form id="contactForm" class="contact card" novalidate>
        <div class="row">
          <label>Nombre
            <input type="text" name="nombre" required />
          </label>
          <label>Email
            <input type="email" name="email" required />
          </label>
        </div>
        <label>Mensaje
          <textarea name="mensaje" rows="4" required></textarea>
        </label>
        <button type="submit" class="btn-primary">Enviar</button>
        <p id="formSuccess" class="success" hidden>Mensaje enviado. Gracias por contactarnos.</p>
      </form>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <p>&copy; <span id="year"></span> GamaHN. Todos los derechos reservados.</p>
    </div>
  </footer>

  <!-- JS del formulario y aÃ±o actual -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // AÃ±o actual en footer
      document.getElementById('year').textContent = new Date().getFullYear();

      // Formulario
      const form = document.getElementById('contactForm');
      const formSuccess = document.getElementById('formSuccess');

      // URL de tu Web App de Google Apps Script
      const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwONwjTcP1ZuM5hEIozEj5jfoLA_y4am-wT8pb91Jy5eCl-bDQUmfDIvixp_zO7yXqs/exec";

      form.addEventListener('submit', async e => {
        e.preventDefault();

        const nombre = form.nombre.value.trim();
        const email = form.email.value.trim();
        const mensaje = form.mensaje.value.trim();

        if (!nombre || !email || !mensaje) {
          alert("Por favor completa todos los campos.");
          return;
        }

        const data = new FormData();
        data.append("nombre", nombre);
        data.append("email", email);
        data.append("mensaje", mensaje);

        try {
          const response = await fetch(WEB_APP_URL, {
            method: "POST",
            body: data
          });
          const result = await response.json();

          if (result.status === "success") {
            form.reset();
            formSuccess.hidden = false;
            setTimeout(() => formSuccess.hidden = true, 3000);
          } else {
            alert("Error al enviar: " + result.message);
          }
        } catch (error) {
          console.error(error);
          alert("No se pudo enviar el mensaje. Intenta de nuevo.");
        }
      });
    });
  </script>

  <footer class="footer">
    <div class="container subfooter">
      <span>&copy; <span id="year"></span> GamaHN. Todos los derechos reservados.</span>
    </div>
  </footer>

  <script src="app.js"></script>
  <script>
    // Cargar propiedades desde panel
    const panelProps = JSON.parse(localStorage.getItem("panelProps") || "[]");
    panelProps.forEach(p => PROPS.push(p));
    applyFilters();
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
